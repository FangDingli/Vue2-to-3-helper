# 前言

Vue 3.0 从 2020 年 9 月份中旬正式发布，到 2022 年 2 月份代替 Vue 2 成为 Vue 的默认版本，至今经过多年发展，周边生态已完全发展成熟，现已完全可以用于生产环境。



我从 Vue 3 Beta 版本开始对 Vue 3 保持高关注度，并开始将自己写的项目全面转向 Vue 3，2021年底首次大胆尝试将 Vue 3 用于公司生产环境（外网，移动端，现仍在使用），内网后续新项目也已准备使用 Vue 3 起步。听到公司有将前端从 2 升级到 3的打算，故写下此文档希望可以帮助对 Vue 3 还不熟悉的伙伴。



此文档适合熟悉使用 Vue 2 并能独立完成开发的人员阅读，只讲述 2 与 3 的差异部分，如对 Vue 2 部分知识点不熟悉请自行学习或询问其他熟悉的伙伴。



## 为什么要升级到 Vue 3

追求最新最前沿的技术本就是我们应该做的，但这也意味着我们将花费更多的时间来学习，而且谁也不能保证这技术真的很有用，那既然这样为什么我们为什么还要升级呢？我们先来细数一下我们升级到 Vue 3 后的得失

##### 缺点

1. 不再支持 IE 11

2. Vue 3 的全新写法增加了较大的心智负担

##### 优点

1. 将内部绝大部分 API 对外暴露，按需编译，同时全部使用 ES6 的模块化导出，完全利用打包器的 `Tree-shaking` 能力，使得相比于 Vue 2 ，有更多功能的 Vue 3 打包大小减少 41% , 初次渲染快 55% , 更新渲染快 133% , 内存减少 54%
   
   - 如：我只整个项目只需要 Vue 3 的响应式系统而没有使用其他功能，那么在打包时打包器将自动剔除其余无用代码而无需引入整个 Vue

2. 重写虚拟DOM，`diff` 算法优化。 Vue 3 新增 `patch flag` 静态标记，当视图更新时，只对比带有 `patch flag` 的节点从而提升性能。 同时对于不参与更新的元素，Vue 3 会对其做 `hoistStatic` 静态提升，只会被创建一次，在更新时直接复用。

3. 基于 `Proxy` 的全新响应式系统，替代 `defineProperty` ， 解决 [Vue 2 历史遗留问题](https://v2.cn.vuejs.org/v2/guide/reactivity.html#%E6%A3%80%E6%B5%8B%E5%8F%98%E5%8C%96%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9) 

4. 全新的 Composition API，方便抽离逻辑

5. 全新全局组件 `Fragment` `Suspense` `Teleport` 

6. ......



可以看出升级到 Vue 3 不管是对于开发体验还是用户体验都是远远利大于弊的，而对于缺点中的不支持 IE11 。 我们公司现在前后端分离的项目一般都要求用户使用 Chrome 浏览器，而升级到 Vue 3 无非就是使 Chrome 版本要求提高了一点。 最后，对于心智负担，Vue 3 完全兼容 Vue 2 的写法，只要你想，你完全可以使用 Options API 来开发。



综上，在 Vue 官方团队的努力下，基本可以无痛从 Vue 2 升级到 Vue 3。



看完了我的吹牛，现在我们开始。
